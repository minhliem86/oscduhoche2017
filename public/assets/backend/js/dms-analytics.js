window._swga={profile_id:"",form_id:"",form_fields:{fullname:"fullname",gender:"gender",email:"email",phone:"phone",mobile:"mobile",address:"address",id_city:"id_city",id_city:"id_country"},_options:{date_format:"d/m/Y"},is_process:!1,isSubmit:!0,base_url_post:"",callback_valid:null,table:"customer",data:{curSearch:window.location.search.substring(1),referrer:document.referrer},_ga:{campaign:"",source:"",medium:""},init:function(t,e,s){this.addLead(),this.profile_id=t,this.form_id=e,(""!=this.data.curSearch||""!=this.data.referrer)&&this.analytics(),this.generalLandingPage();var i=document.getElementById(this.form_id),a=this;if(!this.isNotSet(i)){var n=["default","callback","manual"];switch((this.isNotSet(s)||-1==n.indexOf(s))&&(s="default"),s){case"default":try{i.addEventListener("submit",function(t){return t.preventDefault(),a.postLead(),!1})}catch(o){i.attachEvent("onsubmit",function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,a.postLead(),!1})}break;case"callback":try{i.addEventListener("submit",function(t){return t.preventDefault(),"function"==typeof a.callback_valid&&a.callback_valid()&&a.postLead(),!1})}catch(o){i.attachEvent("onsubmit",function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,"function"==typeof a.callback_valid&&a.callback_valid()&&a.postLead(),!1})}}}},addLead:function(){"function"==typeof window.ga&&this.isset(sessionStorage.sw_success)&&1==sessionStorage.sw_success&&(sessionStorage.removeItem("sw_success"),window.ga("send","event","category","action",{metric1:1}))},loadForm:function(t,e){this.form_fields=t,"undefined"!=typeof e&&(this._options=this.mergeRecursive(this._options,e))},analytics:function(){var t={seo:/^(http:\/\/|https:\/\/)?(www\.)?google(\.com?)?(\.[a-z]{2})?(.*)?$/,adw:/^(http:\/\/|https:\/\/)?(www\.)?doubleclick\.net(.*)?$/i,direct:new RegExp("^(http://|https://)?(www.)?"+window.location.host+"(.*)?$")},e=this.getParams(this.data.curSearch);if(this.isset(e.utm_source))this._ga.source=e.utm_source,this._ga.campaign=this.isset(e.utm_campaign)?e.utm_campaign:"",this._ga.medium=this.isset(e.utm_medium)?e.utm_medium:"";else{if(!this.isset(this.data.referrer)||this.data.referrer.match(t.direct))return;if(this._ga.campaign="",this.isset(e.gclid)&&(this.data.referrer.match(t.seo)||this.data.referrer.match(t.adw)))this._ga.source="google",this._ga.medium="cpc";else if(this.data.referrer.match(t.seo)){var s=this.parseUrl(this.data.referrer);this._ga.source=s.host,this._ga.medium="organic"}else{var s=this.parseUrl(this.data.referrer);this._ga.source=s.host,$medium="referral"}}sessionStorage.setItem("sw_campaign",this._ga.campaign),sessionStorage.setItem("sw_source",this._ga.source),sessionStorage.setItem("sw_medium",this._ga.medium)},generalLandingPage:function(){var t=window.location.pathname+window.location.search,e=!1;t=t.replace(/utm_campaign(=([^\&]*))?\&?/,""),t=t.replace(/utm_source(=([^\&]*))?\&?/,""),t=t.replace(/utm_medium(=([^\&]*))?\&?/,""),t=t.replace(/gclid=([^\&]*)\&?/,""),t!=window.location.pathname+window.location.search&&(e=!0,t=t.replace(/[\?\&]$/,"")),(this.isNotSet(sessionStorage.sw_landing_page)||e)&&sessionStorage.setItem("sw_landing_page",t)},postLead:function(){if(!this.is_process){this.is_process=!0;var t=[],e=document.getElementById(this.form_id),s=this.getGA();for(field in s)t.push(field+"="+encodeURIComponent(s[field]));t.push("_op_date_format="+encodeURIComponent(this._options.date_format));for(field in this.form_fields)try{switch(field){default:var a=this.form_fields[field].split(","),n=[];for(i in a)n.push(e[a[i].trim()].value);t.push(field+"="+encodeURIComponent(n.join(" ")))}}catch(o){}t.push("table="+encodeURIComponent(_swga.table)),this._ajax(_swga.base_url_post+"/add-lead/index/p/"+this.profile_id+"?url="+encodeURIComponent(location.href),t.join("&"),function(){"Insert successful!"==window._swga._xmlhttp.responseText&&sessionStorage.setItem("sw_success",1),_swga.isSubmit&&document.getElementById(window._swga.form_id).submit()})}},getGA:function(){return{sw_campaign:this.isset(sessionStorage.sw_campaign)?sessionStorage.sw_campaign:"",sw_medium:this.isset(sessionStorage.sw_medium)?sessionStorage.sw_medium:"",sw_source:this.isset(sessionStorage.sw_source)?sessionStorage.sw_source:"",sw_landing_page:this.isset(sessionStorage.sw_landing_page)?sessionStorage.sw_landing_page:""}},isset:function(t){return"undefined"!=typeof t&&null!=t&&""!=t},isNotSet:function(t){return"undefined"==typeof t||null==t||""==t},mergeRecursive:function(t,e){for(var s in e)try{e[s].constructor==Object?t[s]=this.mergeRecursive(t[s],e[s]):t[s]=e[s]}catch(i){t[s]=e[s]}return t},getParams:function(t){var e=function(t,s){var i=s[0],a=i.split("="),n=decodeURIComponent(a[0]),o=decodeURIComponent(a.slice(1).join("=").replace(/[+]/g,"%20"));return"undefined"==typeof t[n]?t[n]=o:t[n]=[].concat(t[n],o),1==s.length?t:e(t,s.slice(1))};return 0==t.length?{}:e({},t.split("&"))},parseUrl:function(t){var e=document.createElement("a");return e.href=t,this.getParams(e.search)},_initXMLHttp:function(){window.XMLHttpRequest?this._xmlhttp=new XMLHttpRequest:this._xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")},_ajax:function(t,e,s,i){this._initXMLHttp(),"undefined"==typeof i&&(i="POST");var a=function(){console.log("Post data error"),document.getElementById(window._swga.form_id).submit()};window.XDomainRequest?(this._xmlhttp=new XDomainRequest,this._xmlhttp.open(i,t,!0),this._xmlhttp.onerror=a,this._xmlhttp.onload=function(){s()},this._xmlhttp.send(e)):(this._xmlhttp.onerror=a,this._xmlhttp.onreadystatechange=function(){4==window._swga._xmlhttp.readyState&&200==window._swga._xmlhttp.status&&s()},this._xmlhttp.open(i,t,!0),this._xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this._xmlhttp.send(e))},_createXmlHttp:function(t){var e=null;try{e=new ActiveXObject(t)}catch(s){}return e}},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});